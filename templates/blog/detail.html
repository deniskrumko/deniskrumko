{% extends "base.html" %}
{% load static i18n %}

{% block extrastyle %}
<link rel="stylesheet" href="https://cdn.plyr.io/3.4.3/plyr.css">
<style media="screen">
  .dk-blog-detail-title {
    font-family: 'Open Sans Condensed', Arial;
    font-weight: 700;
    font-size: 50px;
    margin-top: 15px;
    margin-bottom: 0px;
  }
  .dk-blog-h2 {
    font-family: 'Open Sans Condensed', Arial;
    text-align: center;
  }
  .dk-blog-detail-subtitle {
    margin-top: 0px;
    color: #888;
  }

  @media screen and (max-width: 800px) {
    .dk-blog-detail-title {
      font-size: 35px;
    }
  }

  @media screen and (min-width: 800px) {
    .dk-slideshow {
      transform: scale(0.7);
      top: -100px;
    }
  }
  .dk-date {
    font-size: 12px;
    font-weight: 100;
    color: #aaa;
  }
  .dk-gallery-image {
    box-shadow: 2px 2px 10px #acacac;
    outline: 3px solid white;
    transition: all 0.3s ease;
    transform: scale(1.1);
  }
  .dk-gallery-image:hover{
    transform: scale(1.3) translateY(-15px);
  }
</style>
{% endblock %}

{% block extrajs %}
<script src="{% static 'js/plyr.js' %}" charset="utf-8"></script>
<script>
{% if item.video.source == 'youtube' %}
const player = new Plyr('#player', {});
window.player = player;
{% else %}
const player = new Plyr('#player');
{% endif %}
</script>
{% endblock %}

{% block body %}

{# Menu #}
{% include 'components/menu.html' %}

<div class="uk-container uk-container-small">

{% if item.video %}
  {% if item.video.source == 'youtube' %}
    <div id="player" data-plyr-provider="youtube" data-plyr-embed-id="{{ item.video.youtube_link }}"></div>
  {% else %}
    <video id="player" {% if item.video.poster %}poster="{{ item.video.poster.url }}"{% endif %} controls>
      {% if item.video.link %}
        <source src="{{ item.video.link }}" type="video/mp4" size="720">
      {% endif %}

      {% if item.video.link_hd %}
        <source src="{{ item.video.link_hd }}" type="video/mp4" size="1080">
      {% endif %}

      {% if item.video.link_low %}
        <source src="{{ item.video.link_low }}" type="video/mp4" size="360">
      {% endif %}
    </video>
  {% endif %}
{% endif %}

<h1 class="dk-blog-detail-title">{{ item.title }}</h1>

{% if item.subtitle %}
<p class="dk-blog-detail-subtitle">{{ item.subtitle }}</p>
{% endif %}

{% if item.text %}
  {% autoescape off %}
    {{ item.text }}
  {% endautoescape %}
{% endif %}

{% if item.show_gallery %}
<br>
<hr>
<h2 class="dk-blog-h2">Галерея</h2>
<br>
<div class="uk-child-width-1-3 uk-child-width-1-4@m uk-child-width-1-6@l" uk-grid uk-lightbox="animation: slide">
  {% for image in item.images.all %}
  <div>
      <a class="uk-inline" style="transform: rotate({{ degrees|random }}deg);" href="{{ image.image.url }}" {% if image.description %}data-caption="{{ image.description }}"{% endif %}>
          <img src="{{ image.image.url }}" class="dk-gallery-image" alt="">
      </a>
  </div>
  {% endfor %}
</div>
<br>

{% endif %}

{% if item.relations.exists %}
<br>
<hr>
<h2 class="dk-blog-h2">Также посмотрите</h2>
<div class="uk-child-width-1-3@m uk-child-width-1-3@s" uk-grid>
  {% for blog in item.relations.all %}
  <div class="">
    <div class="uk-padding uk-background-muted">
      <h3 style="margin-bottom: 0px;">{{ blog.related_blog.title }}</h3>
      {% if blog.related_blog.subtitle %}
        <p style="margin-top: 0px;">{{ blog.related_blog.subtitle }}</p>
      {% endif %}
      <a href="{% url 'blog:detail' blog.related_blog.slug %}" class="uk-button uk-button-text">Посмотреть</a>
    </div>
  </div>
  {% endfor %}
</div>

{% endif %}

<p class="dk-date">Опубликовано: {{ item.date }}</p>
<div class="uk-hidden@s">
  <br>
  <a class="uk-button uk-button-default uk-width-1-1" href="{% url 'blog:index' %}">Назад</a>
</div>

</div>
<br>
{% endblock %}
