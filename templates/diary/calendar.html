{% extends "base.html" %}
{% load static i18n %}


{% block extrastyle %}
  <link rel="stylesheet" href="{% static 'css/diary/calendar.css' %}">
  <link rel="stylesheet" href="{% static 'css/diary/detail.css' %}">
{% endblock %}

{% block extrajs %}
{% endblock %}

{% block body %}

{# Menu #}
{% include 'components/menu.html'%}

<div class="uk-container uk-container-small">

  <h2>
    <strong>Календарь</strong>
  </h2>

  <form class="uk-grid-small uk-margin-medium-bottom" uk-grid action="/diary/calendar/" method="post">
    {% csrf_token %}

      <div class="uk-width-1-4@xl uk-width-1-4@l uk-width-1-4@m uk-width-1-1@s">
        <select class="uk-select" name="month">
          {% for month in months %}
            <option value="{{ forloop.counter }}" {% if forloop.counter == current_month %}selected{% endif %}>{{ month }}</option>
          {% endfor %}
          <option value="13" {% if current_month == 13 %}selected{% endif %}>==== Весь год ====</option>
        </select>
      </div>
      <div class="uk-width-1-4@xl uk-width-1-4@l uk-width-1-4@m uk-width-1-1@s">
        <select class="uk-select" name="year">
          {% for year in years %}
            <option {% if year == current_year %}selected{% endif %}>{{ year }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="uk-width-1-4@xl uk-width-1-4@l uk-width-1-4@m uk-width-1-1@s">
        <select class="uk-select" name="entry_type">
            <option {% if entry_type == 1 %}selected{% endif %} value="1">Все записи</option>
            <option {% if entry_type == 2 %}selected{% endif %} value="2">Только законченные</option>
            <option {% if entry_type == 3 %}selected{% endif %} value="3">Только незаконченные</option>
        </select>
      </div>
      <div class="uk-width-1-4@xl uk-width-1-4@l uk-width-1-4@m uk-width-1-1@s">
        <input type="submit" name="" value="Показать" class="uk-button uk-button-primary uk-width-1-1">
      </div>

      <div class="">
        <a href="/diary/" class="uk-button uk-button-text">Назад</a>
      </div>
  </form>

  {% for date, entry in entries %}
    <div class="dk-entry{% if not entry %} dk-entry-faded{% endif %} uk-margin-bottom">
      <div class="dk-edit-link uk-visible@s">
        <a href="{% url 'diary:edit' date=date %}" class="uk-icon-button uk-margin-small-right" uk-icon="icon: pencil; ratio: 1.3;" target="_blank"></a>
        {% if entry %}
        <a href="{{ entry.admin_changelink }}" class="uk-icon-button uk-margin-small-right" uk-icon="icon: cog; ratio: 1.3;" target="_blank"></a>
        {% endif %}
      </div>
      <div class="dk-entry-date">
        <a href="{% url 'diary:edit' date=date %}" target="_blank">
        {{ date|date:'F d, Y (l)' }}
        </a>
        {% if entry and entry.done %}
          <span uk-icon="icon: check; ratio: 1" style="color: #75B53C; position: relative; top: -2px;"></span>
        {% elif entry %}
          <span uk-icon="icon: close; ratio: 1" style="color: red; position: relative; top: -2px;"></span>
        {% endif %}
      </div>

      {% if entry and entry.text %}
        <div class="dk-entry-text">
          {% autoescape off %}
            {{ entry.html }}
          {% endautoescape %}
        </div>
      {% endif %}

    </div>
  {% endfor %}

  <div class="uk-margin-bottom">
    <a href="/diary/" class="uk-button uk-button-text">Назад</a>
  </div>
</div>
{% endblock %}
